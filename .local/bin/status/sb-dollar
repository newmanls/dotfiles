#!/usr/bin/env python3
# api from https://dolarapi.com

import requests


def fetch_data(url: str) -> dict:
    try:
        req = requests.get(url)
        req.raise_for_status()

        return req.json()
    except requests.exceptions.RequestException:
        exit(1)


def format_text(data: list) -> str:
    text = [f"{monitor['promedio']:.2f}" for monitor in data]

    return f"ï…• {' / '.join(text)}"


def format_tooltip(data: list) -> str:
    tooltip = [f"<b>{monitor['nombre']}:</b> Bs. {monitor['promedio']:.2f}"
               for monitor in data]

    return '&#013;'.join(tooltip)


def main():
    url = 'https://ve.dolarapi.com/v1/dolares'
    monitors = ['oficial', 'paralelo']
    raw_data = fetch_data(url)
    data = [monitor for monitor in raw_data if monitor['fuente'] in monitors]

    print(format_text(data))
    print(format_tooltip(data))


if __name__ == '__main__':
    main()
