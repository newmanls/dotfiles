#!/usr/bin/env bash
# dmenu script for session management
# Author: Newman Sanchez (https://github.com/newmanls)

set -euo pipefail

shutdown='Shutdown'
suspend='Suspend'
hibernate='Hibernate'
reboot='Reboot'
logout='Logout'

options="${shutdown}\n${suspend}\n${hibernate}\n${reboot}\n${logout}"

prompt=$(uptime -p | sed 's/up/Uptime:/;s/ day[s]/d/;s/ hour[s]/h/;
    s/ minute[s]/m/;s/,//g')

chosen=$(printf "%b\n" "${options}" | dmenu -p "${prompt}")

case "${chosen}" in
    "${shutdown}")  systemctl poweroff -i ;;
    "${suspend}")   systemctl suspend ;;
    "${hibernate}") systemctl hibernate ;;
    "${reboot}")    systemctl reboot ;;
    "${logout}")    loginctl terminate-user "$(whoami)" ;;
esac
